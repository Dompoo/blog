## EXPLAIN
![[Pasted image 20251017165652.png]]`EXPLAIN <쿼리>` 명령을 통해서 해당 쿼리를 어떻게 수행할지 확인해볼 수 있다.
출력의 다음 항목들이 중요하다.
- `type` : 접근 방법
- `key` : 실제 사용된 인덱스
- `rows` : **예상** 스캔 행 수
- `Extra` : 추가 정보
### type
아래로 내려갈수록 안좋다.
- `const` : PK / UNIQUE 인덱스로 조회 (결과가 무조건 1개)
- `eq_ref` : 조인시 PK / UNIQUE 인덱스로 1개씩 행을 찾을 때
- `ref` : 일반 인덱스를 사용하여 조회
- `range` : 일반 인덱스를 사용하여 범위 조회
- `index` : 인덱스 풀 스캔
- `ALL` : 레코드 풀 스캔
일반적으로 `eq_ref` 까지는 훌륭하며, `ref~range` 가 일반적이며 튜닝을 고려하고, `index, ALL` 은 심각하다.
## EXPLAIN ANALYZE
```text
-> Filter: ((c1_0.issuable = true) and (c1_0.issue_started_at > TIMESTAMP'2019-01-01 00:00:00'))  (cost=2397 rows=80.3) (actual time=0.414..4.28 rows=2401 loops=1)  
    -> Index lookup on c1_0 using mouda_goat3 (coupon_status='ISSUABLE')  (cost=2397 rows=2408) (actual time=0.408..4.06 rows=2408 loops=1)
```
`EXPLAIN`이 예상하는 반면, 실제로 실행시켜 그 결과를 반환한다.
실제 쿼리 진행 순서, 실제 데이터 개수, 소요 시간등을 확인 가능하다.
트리구조로 되어 있으며 아래부터 읽으면 된다.
- `Index lookup on c1_0 using mouda_goat3 (coupon_status='ISSUABLE')  (cost=2397 rows=2408) (actual time=0.408..4.06 rows=2408 loops=1)`
	- `mouda_goat3` 인덱스를 사용했다.
	- 예상 2408 행, 실제 2408 행
	- 소요 시간 0.408 ~ 4.06ms
- `Filter: ((c1_0.issuable = true) and (c1_0.issue_started_at > TIMESTAMP'2019-01-01 00:00:00'))  (cost=2397 rows=80.3) (actual time=0.414..4.28 rows=2401 loops=1)`
	- 실제 레코드에서 필터링 했다.
	- 예상 80 행, 실제 2401 행 (부정확)
	- 소요 시간 0.414 ~ 4.28ms